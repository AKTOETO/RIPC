Не нужен будет главный цикл в библиотеке. Главный цикл приложения снаружи либы будет.
Синхронная будет библиотека или нет. Начал уже реализовывать асинхронный вариант.